---
title: "【Go×gPRC】更新系のAPIにFieldMaskを導入する実装例について紹介したい"
emoji: "🐧"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: []
published: false
---

# 導入

みなさんは更新系の API をどのように実装されていますか？ 🤔

ここで議論したいのは、特にリソースの一部分のみを更新する API になります。
弊社でもそのような API を作る機会がありますが、その際は「全てのフィールドを受け付ける API」を実装していました！
値を変えたいフィールドは更新後の値を渡し、そうでないフィールドは現在の値を渡す、というような使い方になります。

一方で、上記のような API は以下のような問題を抱えています ⚠️

1. すべてのフィールドをリクエストボディに含める必要があるので、全ての値を取得する実装を行う必要がある
1. 新規にフィールドを追加したときに、呼び出している全てのフロントのコードの修正が必要になる

これらの問題を解決するために、フィールドマスク（FieldMask）を導入しました！
事前の調査で、Go×gRPC での FieldMask の実装事例は少ないと感じました。

このブログでは具体例を交えて、FieldMask の実装を紹介したいと思います！

# FieldMask とは

さて、具体的が実装例に入る前に FieldMask の説明を簡単に行いたいと思います！

FieldMask は以下のように proto ファイルで定義されています。

```proto
message FieldMask {
  // The set of field mask paths.
  repeated string paths = 1;
}
```

実装としてはめちゃめちゃシンプルですね！

そして、コメントで以下のように説明されています（最初の数行のみを抜粋しています）。

```proto
// `FieldMask` represents a set of symbolic field paths, for example:
//
//	paths: "f.a"
//	paths: "f.b.d"
//
// Here `f` represents a field in some root message, `a` and `b`
// fields in the message found in `f`, and `d` a field found in the
// message in `f.b`.
//
// Field masks are used to specify a subset of fields that should be
// returned by a get operation or modified by an update operation.
// Field masks also ...
```

# 実装の紹介

# まとめ
